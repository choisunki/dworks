/*! dworks v0.1.0 */
var b=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};function q(o,t){o=o||{},t=t||{};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(o[r]=t[r]);return o}function T(o,t){try{return(t||document).querySelector(o)}catch(r){return null}}function G(o,t){try{return(t||document).querySelectorAll(o)}catch(r){return[]}}function W(o){return o&&o.tagName==="VIDEO"}function B(o){var t="56.25%",r=String(o||"16/9"),s=r.match(/^\s*(\d+(?:\.\d+)?)\s*\/\s*(\d+(?:\.\d+)?)\s*$/);if(!s)return t;var a=parseFloat(s[1]),v=parseFloat(s[2]);if(!isFinite(a)||!isFinite(v)||a<=0||v<=0)return t;var f=v/a*100;return!isFinite(f)||f<=0?t:f.toFixed(2)+"%"}function g(o,t){if(o){if(t){if(!o.paused&&!o.ended)return;try{var r=o.play();r&&typeof r.catch=="function"&&r.catch(function(){})}catch(s){}return}try{o.paused||o.pause()}catch(s){}}}var w={volume_on:['<svg class="ico ico-volume-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">','  <path d="M11 5L6.5 9H3v6h3.5L11 19V5z" fill="currentColor"/>','  <path d="M14.5 8.5a1 1 0 0 1 1.4-.1 6 6 0 0 1 0 7.2 1 1 0 1 1-1.5-1.2 4 4 0 0 0 0-4.8 1 1 0 0 1 .1-1.1z" fill="currentColor"/>','  <path d="M16.8 6.2a1 1 0 0 1 1.4-.1 9 9 0 0 1 0 11.8 1 1 0 1 1-1.5-1.2 7 7 0 0 0 0-9.2 1 1 0 0 1 .1-1.3z" fill="currentColor"/>',"</svg>"].join(""),volume_off:['<svg class="ico ico-volume-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">','  <path d="M11 5L6.5 9H3v6h3.5L11 19V5z" fill="currentColor"/>','  <path d="M14.2 9.2a1 1 0 0 1 1.4 0l1.8 1.8 1.8-1.8a1 1 0 1 1 1.4 1.4L18.8 12l1.8 1.8a1 1 0 1 1-1.4 1.4L17.4 13.4l-1.8 1.8a1 1 0 1 1-1.4-1.4L16 12l-1.8-1.8a1 1 0 0 1 0-1z" fill="currentColor"/>',"</svg>"].join("")};function D(o,t,r){var s={vid:"",controls:!1,muted:!0,autoplay:!0,playsinline:!0,loop:!0,vctrl:!0,preload:t&&(t.play_on_enter||t.pause_on_leave)?"metadata":"auto",wrapClass:"vdo__wrap",a11yLabel:"\uBE0C\uB79C\uB4DC \uC601\uC0C1",ratio:"16/9",fit:"cover",poster:""},a=q(q({},s),t||{});r=r||w;var v=String(a.ratio||"16/9"),f=B(v);v.match(/^\s*(\d+(?:\.\d+)?)\s*\/\s*(\d+(?:\.\d+)?)\s*$/)||(v="16/9",f="56.25%");var m=String(a.fit||"cover").toLowerCase();m!=="contain"&&(m="cover");var x="--ar:"+v+";--ar-pad:"+f+";--fit:"+m+";";a.vctrl&&!a.vid&&(a.vid="vdo_"+new Date().getTime()+"_"+Math.floor(Math.random()*1e5));var k=[a.vid?'id="'+a.vid+'"':"",'src="'+o+'"',a.preload?'preload="'+a.preload+'"':"",a.poster?'poster="'+a.poster+'"':"",a.controls?"controls":"",a.muted?"muted":"",a.autoplay?"autoplay":"",a.loop?"loop":"",a.playsinline?"playsinline":""].filter(function(n){return n!==""}).join(" "),O="";if(a.vctrl){var e=a.muted?" muted":"",i=a.vid;O=['<div class="ctrl'+e+'" data-target="'+i+'" role="group" aria-label="\uBE44\uB514\uC624 \uBCFC\uB968 \uC81C\uC5B4">','  <button type="button" class="vctrl vctrl-volume-off" data-action="unmute" aria-label="\uBCFC\uB968 \uCF1C\uAE30" aria-controls="'+i+'">','    <span class="vctrl-popover" role="tooltip">\uBCFC\uB968 \uCF1C\uAE30</span>',r.volume_on||"ON","  </button>",'  <button type="button" class="vctrl vctrl-volume-on" data-action="mute" aria-label="\uBCFC\uB968 \uB044\uAE30" aria-controls="'+i+'">','    <span class="vctrl-popover" role="tooltip">\uBCFC\uB968 \uB044\uAE30</span>',r.volume_off||"OFF","  </button>",'  <span class="sr-only vctrl-status" aria-live="polite" aria-atomic="true"></span>',"</div>"].join("")}return['<div class="'+a.wrapClass+'" style="'+x+'">','  <span class="vdo__spacer" aria-hidden="true"></span>',"  <video "+k+' class="video" aria-label="'+a.a11yLabel+'"></video>',O,"</div>"].join("")}function J(o){var t=q({vdos:[],icons:null,log:!1,viewportChecker:null},o||{}),r={_vctrlBound:!1,_vctrlHandler:null,_vdoObserver:null,_vdoMap:null};function s(){if(t.log)try{console.log.apply(console,arguments)}catch(e){}}function a(e){if(e){var i=document.getElementById(e);if(W(i)){var n=!!i.muted,l=G('.ctrl[data-target="'+e+'"]');if(!(!l||!l.length))for(var d=0;d<l.length;d++){var c=l[d];c.classList&&(n?c.classList.add("muted"):c.classList.remove("muted"));try{c.setAttribute("aria-label","\uBE44\uB514\uC624 \uBCFC\uB968 \uC81C\uC5B4")}catch(V){}var u=c.querySelector(".vctrl-volume-off"),_=c.querySelector(".vctrl-volume-on"),L=c.querySelector(".vctrl-status");if(u)try{u.setAttribute("aria-hidden",String(!n)),u.setAttribute("tabindex",n?"0":"-1")}catch(V){}if(_)try{_.setAttribute("aria-hidden",String(n)),_.setAttribute("tabindex",n?"-1":"0")}catch(V){}L&&(L.textContent=n?"\uD604\uC7AC \uC74C\uC18C\uAC70 \uC0C1\uD0DC":"\uD604\uC7AC \uBCFC\uB968 \uCF1C\uC9D0 \uC0C1\uD0DC")}}}}function v(e,i){if(e){var n=document.getElementById(e);if(W(n)){n.muted=!i;try{i&&n.paused&&n.play()}catch(l){}a(e)}}}function f(){r._vctrlBound||(r._vctrlBound=!0,r._vctrlHandler=function(e){var i=e.target&&e.target.closest?e.target.closest(".ctrl .vctrl"):null;if(i){e.preventDefault&&e.preventDefault();var n=i.closest?i.closest(".ctrl"):null;if(n){var l=n.getAttribute("data-target"),d=i.getAttribute("data-action");l&&v(l,d==="unmute")}}},document.addEventListener("click",r._vctrlHandler,!1))}function m(e){if(!(!e||!e.length)){var i=typeof b.IntersectionObserver=="function";if(!i){var n=t.viewportChecker;if(!n||!n.enabled||!n.$)return;for(var l=n.$,d=n.pluginName||"viewportChecker",c=0;c<e.length;c++){var u=e[c];if(!(!u||!u.mount)&&!(!u.play_on_enter&&!u.pause_on_leave)){var _=u.observe||u.mount,L=l(_),V=l(u.mount);if(!(!L.length||!V.length)){var j=V.find("video").first();j.length&&(function(S,h,y){try{l(S)[d]({repeat:!0,callbackFunction:function(C,M){M==="add"?y.play_on_enter&&g(h,!0):y.pause_on_leave&&g(h,!1)}})}catch(C){}})(L.get(0),j.get(0),u)}}}return}if(r._vdoObserver){try{r._vdoObserver.disconnect()}catch(S){}r._vdoObserver=null}r._vdoMap=new WeakMap;var N=[0,.01,.1,.25,.35,.5,.75,1],P=new IntersectionObserver(function(S){for(var h=0;h<S.length;h++){var y=S[h],C=r._vdoMap.get(y.target);if(C){var M=C.videoEl,A=C.opt||{},X=typeof A.view_threshold=="number"?A.view_threshold:.35,E=y.isIntersecting&&y.intersectionRatio>=X;E?A.play_on_enter&&g(M,!0):A.pause_on_leave&&g(M,!1)}}},{threshold:N});r._vdoObserver=P;for(var H=0;H<e.length;H++){var p=e[H];if(!(!p||!p.mount)&&!(!p.play_on_enter&&!p.pause_on_leave)){var K=p.observe||p.mount,F=T(K);if(F){var z=T(p.mount);if(z){var R=z.querySelector("video");R&&(r._vdoMap.set(F,{videoEl:R,opt:p}),P.observe(F))}}}}}}function x(){for(var e=t.vdos||[],i=t.icons||w,n=0;n<e.length;n++){var l=e[n];if(!(!l||!l.code||!l.mount)){var d=D(l.code,l,i);if(l.vctrl!==!1&&!l.vid)try{var c=String(d||"").match(/<video\s+[^>]*id=\"([^\"]+)\"/i);c&&c[1]&&(l.vid=c[1])}catch(_){}var u=T(l.mount);u&&(u.innerHTML=d),l.vid&&a(l.vid)}}return f(),m(e),s("[dworks-video] init ok"),O}function k(){if(r._vdoObserver){try{r._vdoObserver.disconnect()}catch(e){}r._vdoObserver=null}if(r._vdoMap=null,r._vctrlHandler){try{document.removeEventListener("click",r._vctrlHandler,!1)}catch(e){}r._vctrlHandler=null}r._vctrlBound=!1,s("[dworks-video] destroy ok")}var O={init:x,destroy:k,vdoVolume:v,syncVctrlA11y:a,controlVideo:g,vdoTag:function(e,i){return D(e,i,t.icons||w)},icons:t.icons||w};return O}var I={create:J,controlVideo:g,vdoTag:function(o,t){return D(o,t,w)},icons:w,calcAspectPad:B};typeof b.__DWORKS_EXPORT__=="function"&&b.__DWORKS_EXPORT__(I);typeof b.window!="undefined"&&(b.DWorksVideo=b.DWorksVideo||I);var Q=I;export{B as calcAspectPad,g as controlVideo,J as create,Q as default,w as icons,D as vdoTag};
/*! dworks-video.js | ES5 | exporter handshake: window.__DWORKS_EXPORT__(mod) */
//# sourceMappingURL=dworks-video.esm.min.js.map
