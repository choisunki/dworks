/*! dworks v1.0.0 */
var w=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};function I(o,t){o=o||{},t=t||{};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(o[e]=t[e]);return o}function q(o,t){try{return(t||document).querySelector(o)}catch(e){return null}}function U(o,t){try{return(t||document).querySelectorAll(o)}catch(e){return[]}}function N(o){return o&&o.tagName==="VIDEO"}function M(o){var t="56.25%",e=String(o||"16/9"),v=e.match(/^\s*(\d+(?:\.\d+)?)\s*\/\s*(\d+(?:\.\d+)?)\s*$/);if(!v)return t;var a=parseFloat(v[1]),s=parseFloat(v[2]);if(!isFinite(a)||!isFinite(s)||a<=0||s<=0)return t;var f=s/a*100;return!isFinite(f)||f<=0?t:f.toFixed(2)+"%"}function _(o,t){if(o){if(t){if(!o.paused&&!o.ended)return;try{var e=o.play();e&&typeof e.catch=="function"&&e.catch(function(){})}catch(v){}return}try{o.paused||o.pause()}catch(v){}}}var h={volume_on:['<svg class="ico ico-volume-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">','  <path d="M11 5L6.5 9H3v6h3.5L11 19V5z" fill="currentColor"/>','  <path d="M14.5 8.5a1 1 0 0 1 1.4-.1 6 6 0 0 1 0 7.2 1 1 0 1 1-1.5-1.2 4 4 0 0 0 0-4.8 1 1 0 0 1 .1-1.1z" fill="currentColor"/>','  <path d="M16.8 6.2a1 1 0 0 1 1.4-.1 9 9 0 0 1 0 11.8 1 1 0 1 1-1.5-1.2 7 7 0 0 0 0-9.2 1 1 0 0 1 .1-1.3z" fill="currentColor"/>',"</svg>"].join(""),volume_off:['<svg class="ico ico-volume-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">','  <path d="M11 5L6.5 9H3v6h3.5L11 19V5z" fill="currentColor"/>','  <path d="M14.2 9.2a1 1 0 0 1 1.4 0l1.8 1.8 1.8-1.8a1 1 0 1 1 1.4 1.4L18.8 12l1.8 1.8a1 1 0 1 1-1.4 1.4L17.4 13.4l-1.8 1.8a1 1 0 1 1-1.4-1.4L16 12l-1.8-1.8a1 1 0 0 1 0-1z" fill="currentColor"/>',"</svg>"].join("")};function S(o,t,e){var v={vid:"",controls:!1,muted:!0,autoplay:!0,playsinline:!0,loop:!0,vctrl:!0,preload:t&&(t.play_on_enter||t.pause_on_leave)?"metadata":"auto",wrapClass:"vdo__wrap",a11yLabel:"\uBE0C\uB79C\uB4DC \uC601\uC0C1",ratio:"16/9",fit:"cover",poster:""},a=I(I({},v),t||{});e=e||h;var s=String(a.ratio||"16/9"),f=M(s);s.match(/^\s*(\d+(?:\.\d+)?)\s*\/\s*(\d+(?:\.\d+)?)\s*$/)||(s="16/9",f="56.25%");var m=String(a.fit||"cover").toLowerCase();m!=="contain"&&(m="cover");var k="--ar:"+s+";--ar-pad:"+f+";--fit:"+m+";";a.vctrl&&!a.vid&&(a.vid="vdo_"+new Date().getTime()+"_"+Math.floor(Math.random()*1e5));var D=[a.vid?'id="'+a.vid+'"':"",'src="'+o+'"',a.preload?'preload="'+a.preload+'"':"",a.poster?'poster="'+a.poster+'"':"",a.controls?"controls":"",a.muted?"muted":"",a.autoplay?"autoplay":"",a.loop?"loop":"",a.playsinline?"playsinline":""].filter(function(n){return n!==""}).join(" "),V="";if(a.vctrl){var r=a.muted?" muted":"",i=a.vid;V=['<div class="ctrl'+r+'" data-target="'+i+'" role="group" aria-label="\uBE44\uB514\uC624 \uBCFC\uB968 \uC81C\uC5B4">','  <button type="button" class="vctrl vctrl-volume-off" data-action="unmute" aria-label="\uBCFC\uB968 \uCF1C\uAE30" aria-controls="'+i+'">','    <span class="vctrl-popover" role="tooltip">\uBCFC\uB968 \uCF1C\uAE30</span>',e.volume_on||"ON","  </button>",'  <button type="button" class="vctrl vctrl-volume-on" data-action="mute" aria-label="\uBCFC\uB968 \uB044\uAE30" aria-controls="'+i+'">','    <span class="vctrl-popover" role="tooltip">\uBCFC\uB968 \uB044\uAE30</span>',e.volume_off||"OFF","  </button>",'  <span class="sr-only vctrl-status" aria-live="polite" aria-atomic="true"></span>',"</div>"].join("")}return['<div class="'+a.wrapClass+'" style="'+k+'">','  <span class="vdo__spacer" aria-hidden="true"></span>',"  <video "+D+' class="video" aria-label="'+a.a11yLabel+'"></video>',V,"</div>"].join("")}function P(o){var t=I({vdos:[],icons:null,log:!1,viewportChecker:null},o||{}),e={_vctrlBound:!1,_vctrlHandler:null,_vdoObserver:null,_vdoMap:null};function v(){if(t.log)try{console.log.apply(console,arguments)}catch(r){}}function a(r){if(r){var i=document.getElementById(r);if(N(i)){var n=!!i.muted,l=U('.ctrl[data-target="'+r+'"]');if(!(!l||!l.length))for(var d=0;d<l.length;d++){var c=l[d];c.classList&&(n?c.classList.add("muted"):c.classList.remove("muted"));try{c.setAttribute("aria-label","\uBE44\uB514\uC624 \uBCFC\uB968 \uC81C\uC5B4")}catch(L){}var u=c.querySelector(".vctrl-volume-off"),y=c.querySelector(".vctrl-volume-on"),O=c.querySelector(".vctrl-status");if(u)try{u.setAttribute("aria-hidden",String(!n)),u.setAttribute("tabindex",n?"0":"-1")}catch(L){}if(y)try{y.setAttribute("aria-hidden",String(n)),y.setAttribute("tabindex",n?"-1":"0")}catch(L){}O&&(O.textContent=n?"\uD604\uC7AC \uC74C\uC18C\uAC70 \uC0C1\uD0DC":"\uD604\uC7AC \uBCFC\uB968 \uCF1C\uC9D0 \uC0C1\uD0DC")}}}}function s(r,i){if(r){var n=document.getElementById(r);if(N(n)){n.muted=!i;try{i&&n.paused&&n.play()}catch(l){}a(r)}}}function f(){e._vctrlBound||(e._vctrlBound=!0,e._vctrlHandler=function(r){var i=r.target&&r.target.closest?r.target.closest(".ctrl .vctrl"):null;if(i){r.preventDefault&&r.preventDefault();var n=i.closest?i.closest(".ctrl"):null;if(n){var l=n.getAttribute("data-target"),d=i.getAttribute("data-action");l&&s(l,d==="unmute")}}},document.addEventListener("click",e._vctrlHandler,!1))}function m(r){if(!(!r||!r.length)){var i=typeof w.IntersectionObserver=="function";if(!i){var n=t.viewportChecker;if(!n||!n.enabled||!n.$)return;for(var l=n.$,d=n.pluginName||"viewportChecker",c=0;c<r.length;c++){var u=r[c];if(!(!u||!u.mount)&&!(!u.play_on_enter&&!u.pause_on_leave)){var y=u.observe||u.mount,O=l(y),L=l(u.mount);if(!(!O.length||!L.length)){var j=L.find("video").first();j.length&&(function(T,g,b){try{l(T)[d]({repeat:!0,callbackFunction:function(A,x){x==="add"?b.play_on_enter&&_(g,!0):b.pause_on_leave&&_(g,!1)}})}catch(A){}})(O.get(0),j.get(0),u)}}}return}if(e._vdoObserver){try{e._vdoObserver.disconnect()}catch(T){}e._vdoObserver=null}e._vdoMap=new WeakMap;var E=[0,.01,.1,.25,.35,.5,.75,1],z=new IntersectionObserver(function(T){for(var g=0;g<T.length;g++){var b=T[g],A=e._vdoMap.get(b.target);if(A){var x=A.videoEl,C=A.opt||{},J=typeof C.view_threshold=="number"?C.view_threshold:.35,Q=b.isIntersecting&&b.intersectionRatio>=J;Q?C.play_on_enter&&_(x,!0):C.pause_on_leave&&_(x,!1)}}},{threshold:E});e._vdoObserver=z;for(var H=0;H<r.length;H++){var p=r[H];if(!(!p||!p.mount)&&!(!p.play_on_enter&&!p.pause_on_leave)){var G=p.observe||p.mount,F=q(G);if(F){var R=q(p.mount);if(R){var B=R.querySelector("video");B&&(e._vdoMap.set(F,{videoEl:B,opt:p}),z.observe(F))}}}}}}function k(){for(var r=t.vdos||[],i=t.icons||h,n=0;n<r.length;n++){var l=r[n];if(!(!l||!l.code||!l.mount)){var d=S(l.code,l,i);if(l.vctrl!==!1&&!l.vid)try{var c=String(d||"").match(/<video\s+[^>]*id=\"([^\"]+)\"/i);c&&c[1]&&(l.vid=c[1])}catch(y){}var u=q(l.mount);u&&(u.innerHTML=d),l.vid&&a(l.vid)}}return f(),m(r),v("[dworks-video] init ok"),V}function D(){if(e._vdoObserver){try{e._vdoObserver.disconnect()}catch(r){}e._vdoObserver=null}if(e._vdoMap=null,e._vctrlHandler){try{document.removeEventListener("click",e._vctrlHandler,!1)}catch(r){}e._vctrlHandler=null}e._vctrlBound=!1,v("[dworks-video] destroy ok")}var V={init:k,destroy:D,vdoVolume:s,syncVctrlA11y:a,controlVideo:_,vdoTag:function(r,i){return S(r,i,t.icons||h)},icons:t.icons||h};return V}var W={create:P,controlVideo:_,vdoTag:function(o,t){return S(o,t,h)},icons:h,calcAspectPad:M};typeof w.__DWORKS_EXPORT__=="function"&&w.__DWORKS_EXPORT__(W);typeof w.window!="undefined"&&(w.DWorksVideo=w.DWorksVideo||W);var K=W;var X={video:K,createVideo:P,utils:{controlVideo:_,vdoTag:S,calcAspectPad:M,icons:h}};typeof globalThis!="undefined"&&typeof globalThis.window!="undefined"&&(globalThis.DWorks=globalThis.DWorks||X);var $=X;export{M as calcAspectPad,_ as controlVideo,P as create,$ as default,h as icons,S as vdoTag,K as video};
/*! dworks-video.js | ES5 | exporter handshake: window.__DWORKS_EXPORT__(mod) */
//# sourceMappingURL=dworks.esm.min.js.map
