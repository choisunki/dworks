{
  "version": 3,
  "sources": ["../src/modules/image-load.js"],
  "sourcesContent": ["function dload(target, opts = {}) {\n  const options = Object.assign({\n    cmessage: false,\n    lazyAttrs: ['data-src', 'data-lazy', 'data-original'],\n    cbMode: 'section', // 'section' | 'all'\n    timeoutMs: 0,\n  }, opts);\n  const hasNodeList = typeof NodeList !== 'undefined';\n  const sections = hasNodeList && target instanceof NodeList || Array.isArray(target) ? target : [target];\n  const isAllMode = options.cbMode === 'all';\n  let pendingSections = sections.length;\n\n  const callCb = () => {\n    if (typeof options.cb === 'function') options.cb();\n  };\n\n  const completeSection = () => {\n    if (!isAllMode) {\n      callCb();\n      return;\n    }\n    pendingSections -= 1;\n    if (pendingSections <= 0) callCb();\n  };\n\n  if (sections.length === 0) {\n    callCb();\n    return;\n  }\n\n  sections.forEach((section) => {\n    if (!section || !section.querySelectorAll) {\n      completeSection();\n      return;\n    }\n\n    const imgs = section.querySelectorAll('img');\n    const total = imgs.length;\n    let loadedCount = 0;\n\n    if (total === 0) {\n      if (options.cmessage) {\n        console.log('%c Load Complete 0ea', 'background: green; color: #111; border-radius: 2px; padding: 5px 10px;');\n      }\n      completeSection();\n      return;\n    }\n\n    const handleLoaded = () => {\n      loadedCount += 1;\n      if (options.cmessage) {\n        console.log(`%c => Loading ${loadedCount}ea`, 'background: #111; color: green; border-radius: 2px;');\n      }\n      if (loadedCount === total) {\n        if (options.cmessage) {\n          console.log(`%c Load Complete ${loadedCount}ea`, 'background: green; color: #111; border-radius: 2px; padding: 5px 10px;');\n        }\n        completeSection();\n      }\n    };\n\n    imgs.forEach((imgEl) => {\n      const img = new Image();\n      let fired = false;\n      let timer = null;\n      const once = () => {\n        if (fired) return;\n        fired = true;\n        if (timer) {\n          clearTimeout(timer);\n          timer = null;\n        }\n        handleLoaded();\n      };\n\n      img.onload = once;\n      img.onerror = once;\n      const lazyAttrs = Array.isArray(options.lazyAttrs) ? options.lazyAttrs : [];\n      let resolvedSrc = '';\n\n      if (imgEl.currentSrc) resolvedSrc = imgEl.currentSrc;\n      if (!resolvedSrc && imgEl.src) resolvedSrc = imgEl.src;\n      if (!resolvedSrc) resolvedSrc = imgEl.getAttribute('src') || '';\n      if (!resolvedSrc) {\n        for (let i = 0; i < lazyAttrs.length; i += 1) {\n          const attrVal = imgEl.getAttribute(lazyAttrs[i]);\n          if (attrVal) {\n            resolvedSrc = attrVal;\n            break;\n          }\n        }\n      }\n\n      if (!resolvedSrc) {\n        once();\n        return;\n      }\n\n      const timeoutMs = Number(options.timeoutMs) || 0;\n      if (timeoutMs > 0) {\n        timer = setTimeout(() => {\n          once();\n        }, timeoutMs);\n      }\n\n      img.src = resolvedSrc;\n\n      if (img.complete) {\n        if (img.naturalWidth > 0) once();\n        else img.onerror && img.onerror();\n      }\n    });\n  });\n}\n\nconst mod = { dload };\n\nif (typeof globalThis !== 'undefined' && typeof globalThis.window !== 'undefined') {\n  globalThis.DWorksImageLoad = globalThis.DWorksImageLoad || mod;\n}\n\nexport { dload };\nexport default mod;\n"],
  "mappings": ";;;;;;;;;AAAA,SAASA,EAAMC,EAAQC,EAAO,CAAC,EAAG,CAChC,IAAMC,EAAU,OAAO,OAAO,CAC5B,SAAU,GACV,UAAW,CAAC,WAAY,YAAa,eAAe,EACpD,OAAQ,UACR,UAAW,CACb,EAAGD,CAAI,EAEDE,EADc,OAAO,UAAa,aACRH,aAAkB,UAAY,MAAM,QAAQA,CAAM,EAAIA,EAAS,CAACA,CAAM,EAChGI,EAAYF,EAAQ,SAAW,MACjCG,EAAkBF,EAAS,OAEzBG,EAAS,IAAM,CACf,OAAOJ,EAAQ,IAAO,YAAYA,EAAQ,GAAG,CACnD,EAEMK,EAAkB,IAAM,CAC5B,GAAI,CAACH,EAAW,CACdE,EAAO,EACP,MACF,CACAD,GAAmB,EACfA,GAAmB,GAAGC,EAAO,CACnC,EAEA,GAAIH,EAAS,SAAW,EAAG,CACzBG,EAAO,EACP,MACF,CAEAH,EAAS,QAASK,GAAY,CAC5B,GAAI,CAACA,GAAW,CAACA,EAAQ,iBAAkB,CACzCD,EAAgB,EAChB,MACF,CAEA,IAAME,EAAOD,EAAQ,iBAAiB,KAAK,EACrCE,EAAQD,EAAK,OACfE,EAAc,EAElB,GAAID,IAAU,EAAG,CACXR,EAAQ,UACV,QAAQ,IAAI,uBAAwB,wEAAwE,EAE9GK,EAAgB,EAChB,MACF,CAEA,IAAMK,EAAe,IAAM,CACzBD,GAAe,EACXT,EAAQ,UACV,QAAQ,IAAI,iBAAiBS,CAAW,KAAM,qDAAqD,EAEjGA,IAAgBD,IACdR,EAAQ,UACV,QAAQ,IAAI,oBAAoBS,CAAW,KAAM,wEAAwE,EAE3HJ,EAAgB,EAEpB,EAEAE,EAAK,QAASI,GAAU,CACtB,IAAMC,EAAM,IAAI,MACZC,EAAQ,GACRC,EAAQ,KACNC,EAAO,IAAM,CACbF,IACJA,EAAQ,GACJC,IACF,aAAaA,CAAK,EAClBA,EAAQ,MAEVJ,EAAa,EACf,EAEAE,EAAI,OAASG,EACbH,EAAI,QAAUG,EACd,IAAMC,EAAY,MAAM,QAAQhB,EAAQ,SAAS,EAAIA,EAAQ,UAAY,CAAC,EACtEiB,EAAc,GAKlB,GAHIN,EAAM,aAAYM,EAAcN,EAAM,YACtC,CAACM,GAAeN,EAAM,MAAKM,EAAcN,EAAM,KAC9CM,IAAaA,EAAcN,EAAM,aAAa,KAAK,GAAK,IACzD,CAACM,EACH,QAASC,EAAI,EAAGA,EAAIF,EAAU,OAAQE,GAAK,EAAG,CAC5C,IAAMC,EAAUR,EAAM,aAAaK,EAAUE,CAAC,CAAC,EAC/C,GAAIC,EAAS,CACXF,EAAcE,EACd,KACF,CACF,CAGF,GAAI,CAACF,EAAa,CAChBF,EAAK,EACL,MACF,CAEA,IAAMK,EAAY,OAAOpB,EAAQ,SAAS,GAAK,EAC3CoB,EAAY,IACdN,EAAQ,WAAW,IAAM,CACvBC,EAAK,CACP,EAAGK,CAAS,GAGdR,EAAI,IAAMK,EAENL,EAAI,WACFA,EAAI,aAAe,EAAGG,EAAK,EAC1BH,EAAI,SAAWA,EAAI,QAAQ,EAEpC,CAAC,CACH,CAAC,CACH,CAEA,IAAMS,EAAM,CAAE,MAAAxB,CAAM,EAEhB,OAAO,YAAe,aAAe,OAAO,WAAW,QAAW,cACpE,WAAW,gBAAkB,WAAW,iBAAmBwB,GAI7D,IAAOC,EAAQC",
  "names": ["dload", "target", "opts", "options", "sections", "isAllMode", "pendingSections", "callCb", "completeSection", "section", "imgs", "total", "loadedCount", "handleLoaded", "imgEl", "img", "fired", "timer", "once", "lazyAttrs", "resolvedSrc", "i", "attrVal", "timeoutMs", "mod", "image_load_default", "mod"]
}
