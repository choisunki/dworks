{
  "version": 3,
  "sources": ["../src/modules/image-load.js"],
  "sourcesContent": ["function dload(target, opts = {}) {\n  const options = Object.assign({\n    cmessage: false,\n    lazyAttrs: ['data-src', 'data-lazy', 'data-original'],\n    cbMode: 'section', // 'section' | 'all'\n    timeoutMs: 0,\n  }, opts);\n  const hasNodeList = typeof NodeList !== 'undefined';\n  const sections = hasNodeList && target instanceof NodeList || Array.isArray(target) ? target : [target];\n  const isAllMode = options.cbMode === 'all';\n  let pendingSections = sections.length;\n\n  const callCb = () => {\n    if (typeof options.cb === 'function') options.cb();\n  };\n\n  const completeSection = () => {\n    if (!isAllMode) {\n      callCb();\n      return;\n    }\n    pendingSections -= 1;\n    if (pendingSections <= 0) callCb();\n  };\n\n  if (sections.length === 0) {\n    callCb();\n    return;\n  }\n\n  sections.forEach((section) => {\n    if (!section || !section.querySelectorAll) {\n      completeSection();\n      return;\n    }\n\n    const imgs = section.querySelectorAll('img');\n    const total = imgs.length;\n    let loadedCount = 0;\n\n    if (total === 0) {\n      if (options.cmessage) {\n        console.log('%c Load Complete 0ea', 'background: green; color: #111; border-radius: 2px; padding: 5px 10px;');\n      }\n      completeSection();\n      return;\n    }\n\n    const handleLoaded = () => {\n      loadedCount += 1;\n      if (options.cmessage) {\n        console.log(`%c => Loading ${loadedCount}ea`, 'background: #111; color: green; border-radius: 2px;');\n      }\n      if (loadedCount === total) {\n        if (options.cmessage) {\n          console.log(`%c Load Complete ${loadedCount}ea`, 'background: green; color: #111; border-radius: 2px; padding: 5px 10px;');\n        }\n        completeSection();\n      }\n    };\n\n    imgs.forEach((imgEl) => {\n      const img = new Image();\n      let fired = false;\n      let timer = null;\n      const once = () => {\n        if (fired) return;\n        fired = true;\n        if (timer) {\n          clearTimeout(timer);\n          timer = null;\n        }\n        handleLoaded();\n      };\n\n      img.onload = once;\n      img.onerror = once;\n      const lazyAttrs = Array.isArray(options.lazyAttrs) ? options.lazyAttrs : [];\n      let resolvedSrc = '';\n\n      if (imgEl.currentSrc) resolvedSrc = imgEl.currentSrc;\n      if (!resolvedSrc && imgEl.src) resolvedSrc = imgEl.src;\n      if (!resolvedSrc) resolvedSrc = imgEl.getAttribute('src') || '';\n      if (!resolvedSrc) {\n        for (let i = 0; i < lazyAttrs.length; i += 1) {\n          const attrVal = imgEl.getAttribute(lazyAttrs[i]);\n          if (attrVal) {\n            resolvedSrc = attrVal;\n            break;\n          }\n        }\n      }\n\n      if (!resolvedSrc) {\n        once();\n        return;\n      }\n\n      const timeoutMs = Number(options.timeoutMs) || 0;\n      if (timeoutMs > 0) {\n        timer = setTimeout(() => {\n          once();\n        }, timeoutMs);\n      }\n\n      img.src = resolvedSrc;\n\n      if (img.complete) {\n        if (img.naturalWidth > 0) once();\n        else img.onerror && img.onerror();\n      }\n    });\n  });\n}\n\nconst mod = { dload };\n\nif (typeof globalThis !== 'undefined' && typeof globalThis.window !== 'undefined') {\n  globalThis.DWorksImageLoad = globalThis.DWorksImageLoad || mod;\n}\n\nexport { dload };\nexport default mod;\n"],
  "mappings": "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",
  "names": []
}
