{
  "version": 3,
  "sources": ["../src/modules/image-load.js"],
  "sourcesContent": ["function dload(target, opts = {}) {\n  const options = Object.assign({\n    cmessage: false,\n    lazyAttrs: ['data-src', 'data-lazy', 'data-original'],\n    cbMode: 'section', // 'section' | 'all'\n    timeoutMs: 0,\n  }, opts);\n  const hasNodeList = typeof NodeList !== 'undefined';\n  const sections = hasNodeList && target instanceof NodeList || Array.isArray(target) ? target : [target];\n  const isAllMode = options.cbMode === 'all';\n  let pendingSections = sections.length;\n\n  const callCb = () => {\n    if (typeof options.cb === 'function') options.cb();\n  };\n\n  const completeSection = () => {\n    if (!isAllMode) {\n      callCb();\n      return;\n    }\n    pendingSections -= 1;\n    if (pendingSections <= 0) callCb();\n  };\n\n  if (sections.length === 0) {\n    callCb();\n    return;\n  }\n\n  sections.forEach((section) => {\n    if (!section || !section.querySelectorAll) {\n      completeSection();\n      return;\n    }\n\n    const imgs = section.querySelectorAll('img');\n    const total = imgs.length;\n    let loadedCount = 0;\n\n    if (total === 0) {\n      if (options.cmessage) {\n        console.log('%c Load Complete 0ea', 'background: green; color: #111; border-radius: 2px; padding: 5px 10px;');\n      }\n      completeSection();\n      return;\n    }\n\n    const handleLoaded = () => {\n      loadedCount += 1;\n      if (options.cmessage) {\n        console.log(`%c => Loading ${loadedCount}ea`, 'background: #111; color: green; border-radius: 2px;');\n      }\n      if (loadedCount === total) {\n        if (options.cmessage) {\n          console.log(`%c Load Complete ${loadedCount}ea`, 'background: green; color: #111; border-radius: 2px; padding: 5px 10px;');\n        }\n        completeSection();\n      }\n    };\n\n    imgs.forEach((imgEl) => {\n      const img = new Image();\n      let fired = false;\n      let timer = null;\n      const once = () => {\n        if (fired) return;\n        fired = true;\n        if (timer) {\n          clearTimeout(timer);\n          timer = null;\n        }\n        handleLoaded();\n      };\n\n      img.onload = once;\n      img.onerror = once;\n      const lazyAttrs = Array.isArray(options.lazyAttrs) ? options.lazyAttrs : [];\n      let resolvedSrc = '';\n\n      if (imgEl.currentSrc) resolvedSrc = imgEl.currentSrc;\n      if (!resolvedSrc && imgEl.src) resolvedSrc = imgEl.src;\n      if (!resolvedSrc) resolvedSrc = imgEl.getAttribute('src') || '';\n      if (!resolvedSrc) {\n        for (let i = 0; i < lazyAttrs.length; i += 1) {\n          const attrVal = imgEl.getAttribute(lazyAttrs[i]);\n          if (attrVal) {\n            resolvedSrc = attrVal;\n            break;\n          }\n        }\n      }\n\n      if (!resolvedSrc) {\n        once();\n        return;\n      }\n\n      const timeoutMs = Number(options.timeoutMs) || 0;\n      if (timeoutMs > 0) {\n        timer = setTimeout(() => {\n          once();\n        }, timeoutMs);\n      }\n\n      img.src = resolvedSrc;\n\n      if (img.complete) {\n        if (img.naturalWidth > 0) once();\n        else img.onerror && img.onerror();\n      }\n    });\n  });\n}\n\nconst mod = { dload };\n\nif (typeof globalThis !== 'undefined' && typeof globalThis.window !== 'undefined') {\n  globalThis.DWorksImageLoad = globalThis.DWorksImageLoad || mod;\n}\n\nexport { dload };\nexport default mod;\n"],
  "mappings": "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",
  "names": []
}
