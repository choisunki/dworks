/*!
 * @name dworks-video
 * @version v1.0.0
 * @author Choi Sunki <sk@daltan.net>
 * @description Operational Video Engine for DALTAN WORKS
 * @repository https://github.com/choisunki/dworks
 * @license MIT
 * @preserve
 */
"use strict";var DWorksVideo=(()=>{var q=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var Y=Object.prototype.hasOwnProperty;var Z=(a,e)=>{for(var r in e)q(a,r,{get:e[r],enumerable:!0})},$=(a,e,r,v)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of U(e))!Y.call(a,t)&&t!==r&&q(a,t,{get:()=>e[t],enumerable:!(v=Q(e,t))||v.enumerable});return a};var rr=a=>$(q({},"__esModule",{value:!0}),a);var ar={};Z(ar,{calcAspectPad:()=>j,controlVideo:()=>_,create:()=>K,default:()=>tr,icons:()=>h,vdoTag:()=>x});var w=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};function I(a,e){a=a||{},e=e||{};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r]);return a}function D(a,e){try{return(e||document).querySelector(a)}catch(r){return null}}function er(a,e){try{return(e||document).querySelectorAll(a)}catch(r){return[]}}function N(a){return a&&a.tagName==="VIDEO"}function j(a){var e="56.25%",r=String(a||"16/9"),v=r.match(/^\s*(\d+(?:\.\d+)?)\s*\/\s*(\d+(?:\.\d+)?)\s*$/);if(!v)return e;var t=parseFloat(v[1]),s=parseFloat(v[2]);if(!isFinite(t)||!isFinite(s)||t<=0||s<=0)return e;var f=s/t*100;return!isFinite(f)||f<=0?e:f.toFixed(2)+"%"}function _(a,e){if(a){if(e){if(!a.paused&&!a.ended)return;try{var r=a.play();r&&typeof r.catch=="function"&&r.catch(function(){})}catch(v){}return}try{a.paused||a.pause()}catch(v){}}}var h={volume_on:['<svg class="ico ico-volume-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">','  <path d="M11 5L6.5 9H3v6h3.5L11 19V5z" fill="currentColor"/>','  <path d="M14.5 8.5a1 1 0 0 1 1.4-.1 6 6 0 0 1 0 7.2 1 1 0 1 1-1.5-1.2 4 4 0 0 0 0-4.8 1 1 0 0 1 .1-1.1z" fill="currentColor"/>','  <path d="M16.8 6.2a1 1 0 0 1 1.4-.1 9 9 0 0 1 0 11.8 1 1 0 1 1-1.5-1.2 7 7 0 0 0 0-9.2 1 1 0 0 1 .1-1.3z" fill="currentColor"/>',"</svg>"].join(""),volume_off:['<svg class="ico ico-volume-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">','  <path d="M11 5L6.5 9H3v6h3.5L11 19V5z" fill="currentColor"/>','  <path d="M14.2 9.2a1 1 0 0 1 1.4 0l1.8 1.8 1.8-1.8a1 1 0 1 1 1.4 1.4L18.8 12l1.8 1.8a1 1 0 1 1-1.4 1.4L17.4 13.4l-1.8 1.8a1 1 0 1 1-1.4-1.4L16 12l-1.8-1.8a1 1 0 0 1 0-1z" fill="currentColor"/>',"</svg>"].join("")};function x(a,e,r){var v={vid:"",controls:!1,muted:!0,autoplay:!0,playsinline:!0,loop:!0,vctrl:!0,preload:e&&(e.play_on_enter||e.pause_on_leave)?"metadata":"auto",wrapClass:"vdo__wrap",a11yLabel:"\uBE0C\uB79C\uB4DC \uC601\uC0C1",ratio:"16/9",fit:"cover",poster:""},t=I(I({},v),e||{});r=r||h;var s=String(t.ratio||"16/9"),f=j(s);s.match(/^\s*(\d+(?:\.\d+)?)\s*\/\s*(\d+(?:\.\d+)?)\s*$/)||(s="16/9",f="56.25%");var m=String(t.fit||"cover").toLowerCase();m!=="contain"&&(m="cover");var k="--ar:"+s+";--ar-pad:"+f+";--fit:"+m+";";t.vctrl&&!t.vid&&(t.vid="vdo_"+new Date().getTime()+"_"+Math.floor(Math.random()*1e5));var H=[t.vid?'id="'+t.vid+'"':"",'src="'+a+'"',t.preload?'preload="'+t.preload+'"':"",t.poster?'poster="'+t.poster+'"':"",t.controls?"controls":"",t.muted?"muted":"",t.autoplay?"autoplay":"",t.loop?"loop":"",t.playsinline?"playsinline":""].filter(function(n){return n!==""}).join(" "),O="";if(t.vctrl){var o=t.muted?" muted":"",i=t.vid;O=['<div class="ctrl'+o+'" data-target="'+i+'" role="group" aria-label="\uBE44\uB514\uC624 \uBCFC\uB968 \uC81C\uC5B4">','  <button type="button" class="vctrl vctrl-volume-off" data-action="unmute" aria-label="\uBCFC\uB968 \uCF1C\uAE30" aria-controls="'+i+'">','    <span class="vctrl-popover" role="tooltip">\uBCFC\uB968 \uCF1C\uAE30</span>',r.volume_on||"ON","  </button>",'  <button type="button" class="vctrl vctrl-volume-on" data-action="mute" aria-label="\uBCFC\uB968 \uB044\uAE30" aria-controls="'+i+'">','    <span class="vctrl-popover" role="tooltip">\uBCFC\uB968 \uB044\uAE30</span>',r.volume_off||"OFF","  </button>",'  <span class="sr-only vctrl-status" aria-live="polite" aria-atomic="true"></span>',"</div>"].join("")}return['<div class="'+t.wrapClass+'" style="'+k+'">','  <span class="vdo__spacer" aria-hidden="true"></span>',"  <video "+H+' class="video" aria-label="'+t.a11yLabel+'"></video>',O,"</div>"].join("")}function K(a){var e=I({vdos:[],icons:null,log:!1,viewportChecker:null},a||{}),r={_vctrlBound:!1,_vctrlHandler:null,_vdoObserver:null,_vdoMap:null};function v(){if(e.log)try{console.log.apply(console,arguments)}catch(o){}}function t(o){if(o){var i=document.getElementById(o);if(N(i)){var n=!!i.muted,l=er('.ctrl[data-target="'+o+'"]');if(!(!l||!l.length))for(var d=0;d<l.length;d++){var c=l[d];c.classList&&(n?c.classList.add("muted"):c.classList.remove("muted"));try{c.setAttribute("aria-label","\uBE44\uB514\uC624 \uBCFC\uB968 \uC81C\uC5B4")}catch(V){}var u=c.querySelector(".vctrl-volume-off"),y=c.querySelector(".vctrl-volume-on"),L=c.querySelector(".vctrl-status");if(u)try{u.setAttribute("aria-hidden",String(!n)),u.setAttribute("tabindex",n?"0":"-1")}catch(V){}if(y)try{y.setAttribute("aria-hidden",String(n)),y.setAttribute("tabindex",n?"-1":"0")}catch(V){}L&&(L.textContent=n?"\uD604\uC7AC \uC74C\uC18C\uAC70 \uC0C1\uD0DC":"\uD604\uC7AC \uBCFC\uB968 \uCF1C\uC9D0 \uC0C1\uD0DC")}}}}function s(o,i){if(o){var n=document.getElementById(o);if(N(n)){n.muted=!i;try{i&&n.paused&&n.play()}catch(l){}t(o)}}}function f(){r._vctrlBound||(r._vctrlBound=!0,r._vctrlHandler=function(o){var i=o.target&&o.target.closest?o.target.closest(".ctrl .vctrl"):null;if(i){o.preventDefault&&o.preventDefault();var n=i.closest?i.closest(".ctrl"):null;if(n){var l=n.getAttribute("data-target"),d=i.getAttribute("data-action");l&&s(l,d==="unmute")}}},document.addEventListener("click",r._vctrlHandler,!1))}function m(o){if(!(!o||!o.length)){var i=typeof w.IntersectionObserver=="function";if(!i){var n=e.viewportChecker;if(!n||!n.enabled||!n.$)return;for(var l=n.$,d=n.pluginName||"viewportChecker",c=0;c<o.length;c++){var u=o[c];if(!(!u||!u.mount)&&!(!u.play_on_enter&&!u.pause_on_leave)){var y=u.observe||u.mount,L=l(y),V=l(u.mount);if(!(!L.length||!V.length)){var z=V.find("video").first();z.length&&(function(S,g,b){try{l(S)[d]({repeat:!0,callbackFunction:function(C,M){M==="add"?b.play_on_enter&&_(g,!0):b.pause_on_leave&&_(g,!1)}})}catch(C){}})(L.get(0),z.get(0),u)}}}return}if(r._vdoObserver){try{r._vdoObserver.disconnect()}catch(S){}r._vdoObserver=null}r._vdoMap=new WeakMap;var X=[0,.01,.1,.25,.35,.5,.75,1],R=new IntersectionObserver(function(S){for(var g=0;g<S.length;g++){var b=S[g],C=r._vdoMap.get(b.target);if(C){var M=C.videoEl,A=C.opt||{},G=typeof A.view_threshold=="number"?A.view_threshold:.35,J=b.isIntersecting&&b.intersectionRatio>=G;J?A.play_on_enter&&_(M,!0):A.pause_on_leave&&_(M,!1)}}},{threshold:X});r._vdoObserver=R;for(var F=0;F<o.length;F++){var p=o[F];if(!(!p||!p.mount)&&!(!p.play_on_enter&&!p.pause_on_leave)){var E=p.observe||p.mount,T=D(E);if(T){var W=D(p.mount);if(W){var B=W.querySelector("video");B&&(r._vdoMap.set(T,{videoEl:B,opt:p}),R.observe(T))}}}}}}function k(){for(var o=e.vdos||[],i=e.icons||h,n=0;n<o.length;n++){var l=o[n];if(!(!l||!l.code||!l.mount)){var d=x(l.code,l,i);if(l.vctrl!==!1&&!l.vid)try{var c=String(d||"").match(/<video\s+[^>]*id=\"([^\"]+)\"/i);c&&c[1]&&(l.vid=c[1])}catch(y){}var u=D(l.mount);u&&(u.innerHTML=d),l.vid&&t(l.vid)}}return f(),m(o),v("[dworks-video] init ok"),O}function H(){if(r._vdoObserver){try{r._vdoObserver.disconnect()}catch(o){}r._vdoObserver=null}if(r._vdoMap=null,r._vctrlHandler){try{document.removeEventListener("click",r._vctrlHandler,!1)}catch(o){}r._vctrlHandler=null}r._vctrlBound=!1,v("[dworks-video] destroy ok")}var O={init:k,destroy:H,vdoVolume:s,syncVctrlA11y:t,controlVideo:_,vdoTag:function(o,i){return x(o,i,e.icons||h)},icons:e.icons||h};return O}var P={create:K,controlVideo:_,vdoTag:function(a,e){return x(a,e,h)},icons:h,calcAspectPad:j};typeof w.__DWORKS_EXPORT__=="function"&&w.__DWORKS_EXPORT__(P);typeof w.window!="undefined"&&(w.DWorksVideo=w.DWorksVideo||P);var tr=P;return rr(ar);})();
/*! dworks-video.js | ES5 | exporter handshake: window.__DWORKS_EXPORT__(mod) */
//# sourceMappingURL=dworks-video.min.js.map
