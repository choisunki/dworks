/*! dworks v1.0.0 */
var DWorks=(()=>{var q=Object.defineProperty;var oe=Object.getOwnPropertyDescriptor;var ne=Object.getOwnPropertyNames;var ae=Object.prototype.hasOwnProperty;var le=(t,e)=>{for(var r in e)q(t,r,{get:e[r],enumerable:!0})},ie=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of ne(e))!ae.call(t,o)&&o!==r&&q(t,o,{get:()=>e[o],enumerable:!(n=oe(e,o))||n.enumerable});return t};var ce=t=>ie(q({},"__esModule",{value:!0}),t);var fe={};le(fe,{calcAspectPad:()=>x,controlVideo:()=>f,create:()=>T,default:()=>ve,icons:()=>y,vdoTag:()=>C,video:()=>H});var g=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};function z(t,e){t=t||{},e=e||{};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function j(t,e){try{return(e||document).querySelector(t)}catch(r){return null}}function ue(t,e){try{return(e||document).querySelectorAll(t)}catch(r){return[]}}function Q(t){return t&&t.tagName==="VIDEO"}function J(t,e,r){e=e||{};try{var n=r&&r.name?r.name:"Error",o=r&&r.message?r.message:String(r||"");console.warn("[DWorksVideo] \uC7AC\uC0DD \uC2E4\uD328:",n,o)}catch(c){}if(e.log)try{console.info("[DWorksVideo][debug] play-blocked detail:",{video:t,error:r||null})}catch(c){}if(typeof e.onPlaybackBlocked=="function")try{e.onPlaybackBlocked({video:t,error:r||null,reason:"play_blocked"})}catch(c){}if(typeof g.CustomEvent=="function")try{var l=new CustomEvent("dworks-video:play-blocked",{detail:{video:t,error:r||null,reason:"play_blocked"}});document.dispatchEvent(l)}catch(c){}}function U(t){if(t){var e=document.getElementById(t);if(Q(e)){var r=!!e.muted,n=ue('.ctrl[data-target="'+t+'"]');if(!(!n||!n.length))for(var o=0;o<n.length;o++){var l=n[o];l.classList&&(r?l.classList.add("muted"):l.classList.remove("muted"));try{l.setAttribute("aria-label","\uBE44\uB514\uC624 \uBCFC\uB968 \uC81C\uC5B4")}catch(_){}var c=l.querySelector(".vctrl-volume-off"),p=l.querySelector(".vctrl-volume-on"),h=l.querySelector(".vctrl-status");if(c)try{c.setAttribute("aria-hidden",String(!r)),c.setAttribute("tabindex",r?"0":"-1")}catch(_){}if(p)try{p.setAttribute("aria-hidden",String(r)),p.setAttribute("tabindex",r?"-1":"0")}catch(_){}h&&(h.textContent=r?"\uD604\uC7AC \uC74C\uC18C\uAC70 \uC0C1\uD0DC":"\uD604\uC7AC \uBCFC\uB968 \uCF1C\uC9D0 \uC0C1\uD0DC")}}}}function Y(t,e,r){if(t){var n=document.getElementById(t);Q(n)&&(n.muted=!e,e&&n.paused&&f(n,!0,r),U(t))}}var s={bound:!1,refs:0,handler:null};function se(){if(s.bound){s.refs+=1;return}s.handler=function(t){var e=t.target&&t.target.closest?t.target.closest(".ctrl .vctrl"):null;if(e){t.preventDefault&&t.preventDefault();var r=e.closest?e.closest(".ctrl"):null;if(r){var n=r.getAttribute("data-target"),o=e.getAttribute("data-action");n&&Y(n,o==="unmute")}}},document.addEventListener("click",s.handler,!1),s.bound=!0,s.refs=1}function de(){if(s.bound&&(s.refs-=1,!(s.refs>0))){try{document.removeEventListener("click",s.handler,!1)}catch(t){}s.handler=null,s.bound=!1,s.refs=0}}function x(t){var e="56.25%",r=String(t||"16/9"),n=r.match(/^\s*(\d+(?:\.\d+)?)\s*\/\s*(\d+(?:\.\d+)?)\s*$/);if(!n)return e;var o=parseFloat(n[1]),l=parseFloat(n[2]);if(!isFinite(o)||!isFinite(l)||o<=0||l<=0)return e;var c=l/o*100;return!isFinite(c)||c<=0?e:c.toFixed(2)+"%"}function f(t,e,r){if(t){if(e){if(!t.paused&&!t.ended)return;try{var n=t.play();n&&typeof n.catch=="function"&&n.catch(function(o){J(t,r,o)})}catch(o){J(t,r,o)}return}try{t.paused||t.pause()}catch(o){}}}var y={volume_on:['<svg class="ico ico-volume-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">','  <path d="M11 5L6.5 9H3v6h3.5L11 19V5z" fill="currentColor"/>','  <path d="M14.5 8.5a1 1 0 0 1 1.4-.1 6 6 0 0 1 0 7.2 1 1 0 1 1-1.5-1.2 4 4 0 0 0 0-4.8 1 1 0 0 1 .1-1.1z" fill="currentColor"/>','  <path d="M16.8 6.2a1 1 0 0 1 1.4-.1 9 9 0 0 1 0 11.8 1 1 0 1 1-1.5-1.2 7 7 0 0 0 0-9.2 1 1 0 0 1 .1-1.3z" fill="currentColor"/>',"</svg>"].join(""),volume_off:['<svg class="ico ico-volume-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">','  <path d="M11 5L6.5 9H3v6h3.5L11 19V5z" fill="currentColor"/>','  <path d="M14.2 9.2a1 1 0 0 1 1.4 0l1.8 1.8 1.8-1.8a1 1 0 1 1 1.4 1.4L18.8 12l1.8 1.8a1 1 0 1 1-1.4 1.4L17.4 13.4l-1.8 1.8a1 1 0 1 1-1.4-1.4L16 12l-1.8-1.8a1 1 0 0 1 0-1z" fill="currentColor"/>',"</svg>"].join("")};function C(t,e,r){var n={vid:"",controls:!1,muted:!0,autoplay:!0,playsinline:!0,loop:!0,vctrl:!0,preload:e&&(e.play_on_enter||e.pause_on_leave)?"metadata":"auto",wrapClass:"vdo__wrap",a11yLabel:"\uBE0C\uB79C\uB4DC \uC601\uC0C1",ratio:"16/9",fit:"cover",poster:""},o=z(z({},n),e||{});r=r||y;var l=String(o.ratio||"16/9"),c=x(l);l.match(/^\s*(\d+(?:\.\d+)?)\s*\/\s*(\d+(?:\.\d+)?)\s*$/)||(l="16/9",c="56.25%");var p=String(o.fit||"cover").toLowerCase();p!=="contain"&&(p="cover");var h="--ar:"+l+";--ar-pad:"+c+";--fit:"+p+";";o.vctrl&&!o.vid&&(o.vid="vdo_"+new Date().getTime()+"_"+Math.floor(Math.random()*1e5));var _=[o.vid?'id="'+o.vid+'"':"",'src="'+t+'"',o.preload?'preload="'+o.preload+'"':"",o.poster?'poster="'+o.poster+'"':"",o.controls?"controls":"",o.muted?"muted":"",o.autoplay?"autoplay":"",o.loop?"loop":"",o.playsinline?"playsinline":""].filter(function(a){return a!==""}).join(" "),B="";if(o.vctrl){var W=o.muted?" muted":"",m=o.vid;B=['<div class="ctrl'+W+'" data-target="'+m+'" role="group" aria-label="\uBE44\uB514\uC624 \uBCFC\uB968 \uC81C\uC5B4">','  <button type="button" class="vctrl vctrl-volume-off" data-action="unmute" aria-label="\uBCFC\uB968 \uCF1C\uAE30" aria-controls="'+m+'">','    <span class="vctrl-popover" role="tooltip">\uBCFC\uB968 \uCF1C\uAE30</span>',r.volume_on||"ON","  </button>",'  <button type="button" class="vctrl vctrl-volume-on" data-action="mute" aria-label="\uBCFC\uB968 \uB044\uAE30" aria-controls="'+m+'">','    <span class="vctrl-popover" role="tooltip">\uBCFC\uB968 \uB044\uAE30</span>',r.volume_off||"OFF","  </button>",'  <span class="sr-only vctrl-status" aria-live="polite" aria-atomic="true"></span>',"</div>"].join("")}return['<div class="'+o.wrapClass+'" style="'+h+'">','  <span class="vdo__spacer" aria-hidden="true"></span>',"  <video "+_+' class="video" aria-label="'+o.a11yLabel+'"></video>',B,"</div>"].join("")}function T(t){var e=z({vdos:[],icons:null,log:!1,viewportChecker:null},t||{}),r={_vctrlBound:!1,_vdoObserver:null,_vdoMap:null};function n(){if(e.log)try{console.info.apply(console,arguments)}catch(a){}}function o(a,d){if(e.log)try{console.info(a,d)}catch(u){}}function l(a,d){try{console.error(a)}catch(u){}!e.log||typeof d=="undefined"||o("[DWorksVideo][debug] detail:",d)}function c(a){U(a)}function p(a,d){Y(a,d,{log:e.log,onPlaybackBlocked:e.onPlaybackBlocked})}function h(){r._vctrlBound||(r._vctrlBound=!0,se())}function _(a){if(!(!a||!a.length)){var d=typeof g.IntersectionObserver=="function";if(!d){var u=e.viewportChecker;if(!u||!u.enabled||!u.$)return;for(var i=u.$,L=u.pluginName||"viewportChecker",w=0;w<a.length;w++){var v=a[w];if(!(!v||!v.mount)&&!(!v.play_on_enter&&!v.pause_on_leave)){var P=v.observe||v.mount,M=i(P),G=i(v.mount);if(!(!M.length||!G.length)){var N=G.find("video").first();N.length&&(function(D,k,V){try{i(D)[L]({repeat:!0,callbackFunction:function(O,A){A==="add"?V.play_on_enter&&f(k,!0,{log:e.log,onPlaybackBlocked:e.onPlaybackBlocked}):V.pause_on_leave&&f(k,!1)}})}catch(O){}})(M.get(0),N.get(0),v)}}}return}if(r._vdoObserver){try{r._vdoObserver.disconnect()}catch(D){}r._vdoObserver=null}r._vdoMap=new WeakMap;var $=[0,.01,.1,.25,.35,.5,.75,1],E=new IntersectionObserver(function(D){for(var k=0;k<D.length;k++){var V=D[k],O=r._vdoMap.get(V.target);if(O){var A=O.videoEl,S=O.opt||{},re=typeof S.view_threshold=="number"?S.view_threshold:.35,te=V.isIntersecting&&V.intersectionRatio>=re;te?S.play_on_enter&&f(A,!0,{log:e.log,onPlaybackBlocked:e.onPlaybackBlocked}):S.pause_on_leave&&f(A,!1)}}},{threshold:$});r._vdoObserver=E;for(var F=0;F<a.length;F++){var b=a[F];if(!(!b||!b.mount)&&!(!b.play_on_enter&&!b.pause_on_leave)){var ee=b.observe||b.mount,I=j(ee);if(I){var K=j(b.mount);if(K){var X=K.querySelector("video");X&&(r._vdoMap.set(I,{videoEl:X,opt:b}),E.observe(I))}}}}}}function B(){for(var a=e.vdos||[],d=e.icons||y,u=0;u<a.length;u++){var i=a[u];if(!(!i||!i.mount)){var L=i.url;if(!L){l("[DWorksVideo] \uBE44\uB514\uC624 \uACBD\uB85C(url)\uAC00 \uB204\uB77D\uB418\uC5C8\uC2B5\uB2C8\uB2E4. index: "+u,{index:u,item:i});continue}var w=C(L,i,d);if(i.vctrl!==!1&&!i.vid)try{var v=String(w||"").match(/<video\s+[^>]*id=\"([^\"]+)\"/i);v&&v[1]&&(i.vid=v[1])}catch(M){}var P=j(i.mount);P?P.innerHTML=w:l("[DWorksVideo] \uC5D8\uB9AC\uBA3C\uD2B8\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4. mount: "+i.mount,{index:u,mount:i.mount,item:i}),i.vid&&c(i.vid)}}return h(),_(a),n("[DWorksVideo] init ok"),m}function W(){if(r._vdoObserver){try{r._vdoObserver.disconnect()}catch(a){}r._vdoObserver=null}r._vdoMap=null,r._vctrlBound&&de(),r._vctrlBound=!1,n("[DWorksVideo] destroy ok")}var m={init:B,destroy:W,vdoVolume:p,syncVctrlA11y:c,controlVideo:f,vdoTag:function(a,d){return C(a,d,e.icons||y)},icons:e.icons||y};return m}var R={create:T,controlVideo:f,vdoTag:function(t,e){return C(t,e,y)},icons:y,calcAspectPad:x};typeof g.__DWORKS_EXPORT__=="function"&&g.__DWORKS_EXPORT__(R);typeof g.window!="undefined"&&(g.DWorksVideo=g.DWorksVideo||R);var H=R;var Z={video:H,createVideo:T,utils:{controlVideo:f,vdoTag:C,calcAspectPad:x,icons:y}};typeof globalThis!="undefined"&&typeof globalThis.window!="undefined"&&(globalThis.DWorks=globalThis.DWorks||Z);var ve=Z;return ce(fe);})();
/*! dworks-video.js | ES5 | exporter handshake: window.__DWORKS_EXPORT__(mod) */
//# sourceMappingURL=dworks.min.js.map
